\section{Simulation Analysis and Comparison with Theoretical Results}
\label{sec:simulation}

\subsection{Transient Analysis}


Figure~\ref{fig:trans2} shows the simulated transient analysis results for the
envelope detector output voltage, $V_3$.

\begin{figure}[H] \centering
\includegraphics[width=0.4\linewidth]{trans2.pdf}
\caption{Transient output voltage of the envelope detector.}
\label{fig:trans2}
\end{figure}

By analysing the result of the simulation we notice that the solution (and the following ones) 
resulted in an aproximated sinusoidal fuction: in fact, because of the average voltage is not ideal,
the curve has an upward sinusoidal motion and a downward motion described by a negative exponential.  
As far as the result is concerned, the form of the theoretical solution match the one obtained by NGSpice.


Figure~\ref{fig:acm} shows the simulated transient analysis results for the output voltage, which is the output of the
voltage regulator, $V_4$.

\begin{figure}[H] \centering
\includegraphics[width=0.4\linewidth]{acm.pdf}
\caption{Output voltage of the circuit.}
\label{fig:acm}
\end{figure}

Figure~\ref{fig:acp} shows the phase, in degrees, of the frequency response for $v_6$, $v_s$ and the voltage in the capacitor $C$ 
of the circuit under analysis. Compared to the theoretical analysis results, we notice that, again, we obtain the same results, 
since the graphic curves for the theoretical and simulation analysis are similar.

\begin{figure}[H] \centering
\includegraphics[width=0.4\linewidth]{acp.pdf}
\caption{Phase response for node 6, voltage source $V_s$ and capacitor $C$}
\label{fig:acp}
\end{figure}


	Comparing both figures with the respective theoretical results, we conclude that both are similar. Again, the form of each graphic
	is similar to the one described for the envelope detector voltage. If, in this case, we used the same scale as Figure~\ref{fig:trans2},
	we would see that the ripple voltage and voltage difference are very small, which means that we obtained a decent result for 2 of the 3
	parameters that influence the merit.



	Table~\ref{tab1:op} shows the measured results for the maximum, minimum and average output voltage of the circuit $V_4$. 
	Notice that the values on the right were obtained by Octave, therefore they are the theoretical values, which we already 
	mentioned previously but, to facilitate the comparison between the simulation and theoretical values, we mentioned them again.

\begin{table}[H]
  \centering
  \begin{tabular}{|l|r|}
    \hline    
    {\bf Name} & {\bf Voltage[V]} \\ \hline
    \input{../sim/op1_tab}
  \end{tabular}
  \begin{tabular}{|l|r|}
    \hline    
    {\bf Node} & {\bf Voltage[V]} \\ \hline
    \input{../mat/Nodal_tab}
  \end{tabular}
  \begin{tabular}{|l|r|}
    \hline    
    {\bf Name} & {\bf Voltage[V]} \\ \hline
    \input{../mat/ValN_tab}
  \end{tabular}
  \caption {Measured maximum $V_max$, minimum $V_min$ and average $V_avg$ output voltage of the circuit. 
  The values on the right are the theoretical values for the same voltages in the circuit.}
  \label{tab1:op}
\end{table}


	Compared to the theoretical analysis results, we notice that both simulation results are accurate, except for the last 
decimal places, as a consequence of the cientific notation and the number of significative algharisms used by each program to 
present the results. Despite that, we realise that the values with more significant algharisms match correctly the rounded values.


	Table~\ref{tab2:op} shows the ripple voltage of the circuit and the average voltage difference
	between the output voltage and 12 Volts. Again, we show the theoretical values obtained for this step, 
	to make it easier to compare between simulation and theoretical values.


\begin{table}[H]
  \centering
  \begin{tabular}{|l|r|}
    \hline    
    {\bf Name} & {\bf Voltage[V]} \\ \hline
    \input{../sim/op2_tab}
  \end{tabular}
  \begin{tabular}{|l|r|}
    \hline    
    {\bf Name} & {\bf Voltage[V]} \\ \hline
    \input{../mat/Val21_tab}
  \end{tabular}
  \begin{tabular}{|l|r|}
    \hline    
    {\bf Name} & {\bf Voltage[V]} \\ \hline
    \input{../mat/Val22_tab}
  \end{tabular}
  \caption{Ripple voltage $V_max$-$V_min$ and the average voltage difference $V_4$-12. The values on the right are the theoretical 
  values for the same voltages in the circuit.}
  \label{tab2:op}
\end{table}


Table~\ref{tab3:op} shows the total cost of the circuit and the figure of merit of the circuit. 
Note that we used the simulated voltage results to calculate the value of merit.


\begin{table}[H]
  \centering
  \begin{tabular}{|l|r|}
    \hline    
    {\bf Name} & {\bf Merit} \\ \hline
    \input{../sim/op3_tab}
  \end{tabular}
  \caption{Number of components used, its cost and the resultant figure of merit.}
  \label{tab2:op}
\end{table}

By analising the figure of merit, we note that its value, considering the multiple results obtained for different values of the components and layots of the circuit, is
reasonable. Nevertheless, we consider the result not satisfying, since we obtained a merit of around 900 when we eliminated resistor $R_1$ and added 15 more diodes to the series
(reducing considerably the cost, the ripple and the average voltage difference). However, the AC/DC converter obtained would not be an efficient one, since it would have an enourmous
stabilization time and no resistor connected in parallel with the capacitor.

